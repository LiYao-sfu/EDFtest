---
title: "Introduction to the EDFtest Package"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{EDFtest-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

`EDFtest` package contains functions for the calculation of goodness-of-fit test statistics and their P-values. The three statistics computed are the Empirical Distribution function statistics called Cramér-von Mises ($W^{2}$), Anderson-Darling ($A^{2}$), and Watson's statistic ($U^{2}$).

The statistics and their P-values can be used to assess an assumed distribution. In the simplest situation you have an i.i.d. sample from some distribution $F$ and want to test the hypothesis that $F$ is a member of some specific parametric family. The following families are available: N(location=$\mu$,scale=$\sigma^{2}$), Gamma(shape=$\alpha$,scale=$\beta$), Logistic(location=$\mu$,scale=s),
Laplace(location=$\mu$,scale=b),
Weibull(shape=$\alpha$,scale=$\beta$), and
Exponential(scale=$\theta$).

## Theory 
Richard adds it here!


## Example

Here is an example showing you how to use `EDFtest` package to perform goodness-of-fit tests for a given data set. We are going to use Fisher's or Anderson's `iris` data set for our demonstration. `iris` is a data frame with 150 observations and 5 variables which are  `Sepal.Length`, `Sepal.Width`, `Petal.Length`, `Petal.Width`, and `Species`. Assumed that we have a special interest in the width of sepal in this sample. Here is a histogram of it:

```{r}
hist(iris$Sepal.Width, main="Width of sepal")
```

We may conclude that this sample might follow a normal or gamma distribution from above histogram. Now, let's use the `EDFtest` package to perform the goodness-of-fit tests to justify our guess.


```{r,warning = FALSE,message = FALSE}
library(EDFtest)
set.seed("100")
x=iris$Sepal.Width
shape=estimate.gamma(x)[1]
# Anderson-Darling statistic and P-value
(asq=AD.gamma(x))
AD.gamma.pvalue(a=asq,shape=shape)$P
#Cramér-von Mises statistic and P-value
(wsq=CvM.gamma(x))
CvM.gamma.pvalue(w=wsq,shape=shape)$P
#You can also use following generic functions
gof.gamma(x) #Imhof
gof.gamma.bootstrap(x,M=10000) #bootstrap
```

We calculated Anderson-Darling and Cramér-von Mises statistics and P-values of the sample by both Imhof and bootstrap methods. In `AD.gamma.pvalue` and `CvM.gamma.pvalue` functions, we use `imhof` function in `CompQuadForm` package to calculated 100 eigenvalues, by default, for the calculation of their P-values. Using Imhof method, P-value for $A^{2}$ is 0.057625 and for $W^{2}$ is 0.02859593. At the same time, p-values by 10,000 bootstrap are 0.0289 for $A^{2}$ and 0.0576 for $W^{2}$. Both methods are fairly consistent.



Now, we can do similar tests for Normal model.

```{r,warning = FALSE,message = FALSE}
set.seed("100")
# Anderson-Darling statistic and P-value
(asq=AD.normal(x))
AD.normal.pvalue(a=asq)$P
#Cramér-von Mises statistic and P-value
(wsq=CvM.normal(x))
CvM.normal.pvalue(w=wsq)$P
#You can also use following generic functions
gof.normal(x) #Imhof
gof.normal.bootstrap(x,M=10000) #bootstrap
```

We can see that P-value for $A^{2}$ is 0.02037737 and for $W^{2}$ is 0.009486189. At the same time, p-values by 10,000 bootstrap are 0.0205 for $A^{2}$ and 0.0105  for $W^{2}$. Both methods are fairly consistent.
